# ğŸ—ï¸ COMPREHENSIVE LAYERED RESTRUCTURE PLAN
**Layer-Based Architecture with Complete Function Mapping**

---

## ğŸ“Š SYSTEM ARCHITECTURE OVERVIEW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRESENTATION LAYER                      â”‚
â”‚  User Interfaces, Pages, Components, API Routes           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BUSINESS LOGIC LAYER                    â”‚
â”‚  Core Business Functions, Processing, Templates           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA ACCESS LAYER                      â”‚
â”‚  Database, Storage, External APIs, Data Sources           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INFRASTRUCTURE LAYER                   â”‚
â”‚  Configuration, Build Tools, Development, Documentation   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ COMPREHENSIVE LAYERED STRUCTURE

```
plan2fund-nextgen/
â”œâ”€â”€ presentation-layer/                   # LAYER 1: User-facing interfaces
â”‚   â”œâ”€â”€ web-pages/                       # Next.js pages (25 files)
â”‚   â”‚   â”œâ”€â”€ public-marketing/           # Public-facing marketing pages
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx               # Landing page
â”‚   â”‚   â”‚   â”œâ”€â”€ about.tsx               # About us
â”‚   â”‚   â”‚   â”œâ”€â”€ contact.tsx             # Contact page
â”‚   â”‚   â”‚   â”œâ”€â”€ faq.tsx                 # FAQ page
â”‚   â”‚   â”‚   â”œâ”€â”€ legal.tsx               # Legal information
â”‚   â”‚   â”‚   â”œâ”€â”€ privacy.tsx             # Privacy policy
â”‚   â”‚   â”‚   â”œâ”€â”€ terms.tsx               # Terms of service
â”‚   â”‚   â”‚   â””â”€â”€ for.tsx                 # Target audience page
â”‚   â”‚   â”œâ”€â”€ product-application/        # Core product pages
â”‚   â”‚   â”‚   â”œâ”€â”€ editor.tsx              # Business plan editor
â”‚   â”‚   â”‚   â”œâ”€â”€ library.tsx             # Program library
â”‚   â”‚   â”‚   â”œâ”€â”€ pricing.tsx             # Pricing & plans
â”‚   â”‚   â”‚   â”œâ”€â”€ reco.tsx                # Recommendation wizard
â”‚   â”‚   â”‚   â”œâ”€â”€ results.tsx             # Search results
â”‚   â”‚   â”‚   â”œâ”€â”€ preview.tsx             # Document preview
â”‚   â”‚   â”‚   â””â”€â”€ export.tsx              # Export page
â”‚   â”‚   â”œâ”€â”€ user-dashboard/             # User-specific pages
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard.tsx           # User dashboard
â”‚   â”‚   â”‚   â”œâ”€â”€ checkout.tsx            # Payment checkout
â”‚   â”‚   â”‚   â”œâ”€â”€ privacy-settings.tsx    # User settings
â”‚   â”‚   â”‚   â””â”€â”€ program/[id].tsx        # Program details
â”‚   â”‚   â”œâ”€â”€ utility-pages/              # Utility & admin pages
â”‚   â”‚   â”‚   â”œâ”€â”€ advanced-search.tsx     # Advanced search
â”‚   â”‚   â”‚   â”œâ”€â”€ confirm.tsx             # Confirmation pages
â”‚   â”‚   â”‚   â”œâ”€â”€ thank-you.tsx           # Thank you pages
â”‚   â”‚   â”‚   â””â”€â”€ optimized-editor.tsx    # Legacy editor (to remove)
â”‚   â”‚   â””â”€â”€ _app.tsx                    # Next.js app wrapper
â”‚   â”‚
â”‚   â”œâ”€â”€ ui-components/                   # React components (123 files)
â”‚   â”‚   â”œâ”€â”€ business-plan-editor/       # Editor functionality
â”‚   â”‚   â”‚   â”œâ”€â”€ core-editor/           # Main editor components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UnifiedEditor.tsx  # Main orchestrator
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EditorState.tsx    # State management
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StructuredEditor.tsx # Structured editing
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SectionEditor.tsx  # Section editing
â”‚   â”‚   â”‚   â”œâ”€â”€ ai-assistant/          # AI-powered assistance
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EnhancedAIChat.tsx # AI chat interface
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ RequirementsChecker.tsx # Requirements validation
â”‚   â”‚   â”‚   â”œâ”€â”€ financial-tools/       # Financial data management
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FinancialTables.tsx # Financial data tables
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Figures.tsx        # Charts and graphs
â”‚   â”‚   â”‚   â”œâ”€â”€ export-system/         # Document export
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ExportSettings.tsx # Export configuration
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FormattingExportManager.tsx # Format management
â”‚   â”‚   â”‚   â”œâ”€â”€ collaboration/         # Team collaboration
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CollaborationManager.tsx # Collaboration tools
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TeamManager.tsx    # Team management
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ VersionControl.tsx # Version control
â”‚   â”‚   â”‚   â”œâ”€â”€ template-system/       # Template management
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TemplatesFormattingManager.tsx # Template formatting
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ProgramTemplateEditor.tsx # Program templates
â”‚   â”‚   â”‚   â”œâ”€â”€ text-editing/          # Text editing tools
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RichTextEditor.tsx # Rich text editor
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FormHelpModal.tsx  # Help modal
â”‚   â”‚   â”‚   â””â”€â”€ navigation/            # Editor navigation
â”‚   â”‚   â”‚       â”œâ”€â”€ EnhancedNavigation.tsx # Navigation component
â”‚   â”‚   â”‚       â”œâ”€â”€ EntryPointsManager.tsx # Entry point management
â”‚   â”‚   â”‚       â”œâ”€â”€ RouteExtrasPanel.tsx # Route extras
â”‚   â”‚   â”‚       â””â”€â”€ Phase4Integration.tsx # Phase 4 integration
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ recommendation-system/      # Recommendation functionality
â”‚   â”‚   â”‚   â”œâ”€â”€ decision-wizard/       # Decision tree wizard
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DynamicWizard.tsx  # Dynamic wizard
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Wizard.tsx         # Basic wizard
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EnhancedWizard.tsx # Enhanced wizard
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ UnifiedRecommendationWizard.tsx # Unified wizard
â”‚   â”‚   â”‚   â”œâ”€â”€ search-interface/      # Search functionality
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SmartRecommendationFlow.tsx # Smart search flow
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ExplorationModal.tsx # Exploration modal
â”‚   â”‚   â”‚   â”œâ”€â”€ results-display/       # Results presentation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StructuredRequirementsDisplay.tsx # Requirements display
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ProgramDetailsModal.tsx # Program details modal
â”‚   â”‚   â”‚   â””â”€â”€ program-details/       # Program information
â”‚   â”‚   â”‚       â””â”€â”€ ProgramDetails.tsx # Program details component
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pricing-checkout/          # Pricing & payment system
â”‚   â”‚   â”‚   â”œâ”€â”€ pricing-display/       # Pricing presentation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PricingDetails.tsx # Pricing details
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AddonsSection.tsx  # Add-ons section
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RequirementsDisplay.tsx # Requirements display
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ RequirementsMatrix.tsx # Requirements matrix
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FilterTabs.tsx     # Filter tabs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FilterTabContent.tsx # Filter content
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HowItWorksSection.tsx # How it works
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ProofSection.tsx   # Proof section
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DocumentModal.tsx  # Document modal
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DocumentSpecModal.tsx # Document spec modal
â”‚   â”‚   â”‚   â””â”€â”€ checkout-flow/         # Checkout process
â”‚   â”‚   â”‚       â””â”€â”€ CartSummary.tsx    # Cart summary
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ shared-ui/                 # Shared UI components
â”‚   â”‚   â”‚   â”œâ”€â”€ layout-components/     # Layout & navigation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AppShell.tsx       # App shell
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx         # Site header
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Footer.tsx         # Site footer
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Breadcrumbs.tsx    # Breadcrumb navigation
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ InPageBreadcrumbs.tsx # In-page breadcrumbs
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SiteBreadcrumbs.tsx # Site breadcrumbs
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LanguageSwitcher.tsx # Language switcher
â”‚   â”‚   â”‚   â”œâ”€â”€ ui-primitives/         # Basic UI components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx         # Button component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ input.tsx          # Input component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ textarea.tsx       # Textarea component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ card.tsx           # Card component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ dialog.tsx         # Dialog component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ badge.tsx          # Badge component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ label.tsx          # Label component
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ progress.tsx       # Progress component
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ switch.tsx         # Switch component
â”‚   â”‚   â”‚   â”œâ”€â”€ business-components/   # Business-specific components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ hero-sections/     # Hero sections
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Hero.tsx       # Main hero
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ HeroLite.tsx   # Light hero
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ content-sections/  # Content sections
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HowItWorks.tsx # How it works
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WhoItsFor.tsx  # Target audience
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ WhyPlan2Fund.tsx # Why choose us
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ WhyAustria.tsx # Why Austria
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ feature-displays/  # Feature displays
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TargetGroupBanner.tsx # Target group banner
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FundingTypes.tsx # Funding types
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlanTypes.tsx  # Plan types
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Included.tsx   # What's included
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ interactive-elements/ # Interactive elements
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EligibilityCard.tsx # Eligibility card
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EvidenceCards.tsx # Evidence cards
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CTAStrip.tsx   # Call-to-action strip
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Counter.tsx    # Counter component
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Tooltip.tsx    # Tooltip component
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ InfoDrawer.tsx # Info drawer
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ utility-components/ # Utility components
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ DocsUpload.tsx # Document upload
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ HealthFooter.tsx # Health footer
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ SEOHead.tsx    # SEO head
â”‚   â”‚   â”‚   â””â”€â”€ specialized-components/ # Specialized components
â”‚   â”‚   â”‚       â”œâ”€â”€ intake-forms/      # Intake forms
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ IntakeForm.tsx # Main intake form
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ OffTopicGate.tsx # Off-topic gate
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OverlayQuestions.tsx # Overlay questions
â”‚   â”‚   â”‚       â”œâ”€â”€ plan-components/   # Plan-related components
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ PlanIntake.tsx # Plan intake
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ TableOfContents.tsx # Table of contents
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ TitlePage.tsx  # Title page
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ ChartWidget.tsx # Chart widget
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ FinancialsQuickSheet.tsx # Financials sheet
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ StyleTokens.tsx # Style tokens
â”‚   â”‚   â”‚       â”œâ”€â”€ addons/            # Add-ons
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ AddOnChips.tsx # Add-on chips
â”‚   â”‚   â”‚       â”œâ”€â”€ fallback/          # Fallback components
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ZeroMatchFallback.tsx # Zero match fallback
â”‚   â”‚   â”‚       â”œâ”€â”€ gdpr/              # GDPR components
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ConsentBanner.tsx # Consent banner
â”‚   â”‚   â”‚       â”œâ”€â”€ onboarding/       # Onboarding
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ SegmentedOnboarding.tsx # Segmented onboarding
â”‚   â”‚   â”‚       â””â”€â”€ success/           # Success components
â”‚   â”‚   â”‚           â””â”€â”€ SuccessHub.tsx # Success hub
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ admin-interface/           # Admin interface (empty - to be populated)
â”‚   â”‚
â”‚   â””â”€â”€ api-endpoints/                 # API endpoints (20 files)
â”‚       â”œâ”€â”€ data-management/           # Data management APIs
â”‚       â”‚   â”œâ”€â”€ programs.ts            # Programs API
â”‚       â”‚   â”œâ”€â”€ programs-ai.ts         # AI programs API
â”‚       â”‚   â”œâ”€â”€ data/programs.ts       # Data programs API
â”‚       â”‚   â”œâ”€â”€ data/questions.ts      # Questions API
â”‚       â”‚   â””â”€â”€ programmes/[id]/requirements.ts # Program requirements
â”‚       â”œâ”€â”€ data-collection/           # Data collection APIs
â”‚       â”‚   â”œâ”€â”€ scraper/run.ts         # Scraper run API
â”‚       â”‚   â”œâ”€â”€ scraper/status.ts      # Scraper status API
â”‚       â”‚   â””â”€â”€ cron/scraper.ts        # Cron scraper API
â”‚       â”œâ”€â”€ ai-services/               # AI service APIs
â”‚       â”‚   â”œâ”€â”€ ai/generate.ts         # AI generation API
â”‚       â”‚   â”œâ”€â”€ ai/openai.ts           # OpenAI API
â”‚       â”‚   â”œâ”€â”€ ai-assistant.ts        # AI assistant API
â”‚       â”‚   â”œâ”€â”€ ai-assistant-simple.ts # Simple AI assistant API
â”‚       â”‚   â””â”€â”€ intelligent-readiness.ts # Intelligent readiness API
â”‚       â”œâ”€â”€ recommendation/            # Recommendation APIs
â”‚       â”‚   â”œâ”€â”€ recommend.ts           # Recommendation API
â”‚       â”‚   â”œâ”€â”€ decision-tree.ts       # Decision tree API
â”‚       â”‚   â””â”€â”€ requirements.ts        # Requirements API
â”‚       â”œâ”€â”€ payments/                  # Payment APIs
â”‚       â”‚   â”œâ”€â”€ payments/create-session.ts # Create payment session
â”‚       â”‚   â”œâ”€â”€ payments/success.ts    # Payment success
â”‚       â”‚   â””â”€â”€ stripe/webhook.ts      # Stripe webhook
â”‚       â”œâ”€â”€ user-management/           # User management APIs
â”‚       â”‚   â”œâ”€â”€ user/profile.ts        # User profile API
â”‚       â”‚   â”œâ”€â”€ gdpr/delete-data.ts    # GDPR delete data API
â”‚       â”‚   â””â”€â”€ plan/save.ts           # Plan save API
â”‚       â”œâ”€â”€ templates/                 # Template APIs
â”‚       â”‚   â”œâ”€â”€ program-templates.ts   # Program templates API
â”‚       â”‚   â””â”€â”€ intake/parse.ts        # Intake parse API
â”‚       â”œâ”€â”€ intake/plan.ts             # Intake plan API
â”‚       â”œâ”€â”€ analytics/track.ts         # Analytics tracking API
â”‚       â”œâ”€â”€ feature-flags.ts           # Feature flags API
â”‚       â”œâ”€â”€ health.ts                  # Health check API
â”‚       â”œâ”€â”€ test-db.ts                 # Test database API
â”‚       â””â”€â”€ test-simple.ts             # Simple test API
â”‚
â”œâ”€â”€ business-logic-layer/              # LAYER 2: Core business functions
â”‚   â”œâ”€â”€ data-collection/               # Data collection & scraping
â”‚   â”‚   â”œâ”€â”€ web-scrapers/              # Web scraping services
â”‚   â”‚   â”‚   â”œâ”€â”€ webScraperService.ts   # Main web scraper
â”‚   â”‚   â”‚   â””â”€â”€ enhancedDataPipeline.ts # Enhanced data pipeline
â”‚   â”‚   â”œâ”€â”€ data-parsers/              # Data parsing & extraction
â”‚   â”‚   â”‚   â”œâ”€â”€ intakeParser.ts        # Intake data parser
â”‚   â”‚   â”‚   â”œâ”€â”€ decisionTreeParser.ts  # Decision tree parser
â”‚   â”‚   â”‚   â””â”€â”€ requirementsExtractor.ts # Requirements extractor
â”‚   â”‚   â”œâ”€â”€ data-sources/              # Data source management
â”‚   â”‚   â”‚   â”œâ”€â”€ dataSource.ts          # Data source manager
â”‚   â”‚   â”‚   â””â”€â”€ libraryExtractor.ts    # Library data extractor
â”‚   â”‚   â””â”€â”€ pattern-learning/          # Pattern learning & adaptation
â”‚   â”‚       â””â”€â”€ dynamicPatternEngine.ts # Dynamic pattern learning
â”‚   â”‚
â”‚   â”œâ”€â”€ data-processing/               # Data processing & analysis
â”‚   â”‚   â”œâ”€â”€ categorization/            # Data categorization
â”‚   â”‚   â”‚   â””â”€â”€ categoryConverters.ts  # Category conversion logic
â”‚   â”‚   â”œâ”€â”€ recommendation-engine/     # Recommendation system
â”‚   â”‚   â”‚   â”œâ”€â”€ enhancedRecoEngine.ts  # Enhanced recommendation engine
â”‚   â”‚   â”‚   â”œâ”€â”€ dynamicDecisionTree.ts # Dynamic decision tree
â”‚   â”‚   â”‚   â””â”€â”€ dynamicQuestionEngine.ts # Dynamic question engine
â”‚   â”‚   â”œâ”€â”€ validation/                # Data validation
â”‚   â”‚   â”‚   â”œâ”€â”€ validationRules.ts     # Validation rules
â”‚   â”‚   â”‚   â””â”€â”€ conditionalLogic.ts    # Conditional logic
â”‚   â”‚   â””â”€â”€ analysis/                  # Data analysis
â”‚   â”‚       â”œâ”€â”€ advancedSearchDoctor.ts # Advanced search analysis
â”‚   â”‚       â””â”€â”€ doctorDiagnostic.ts    # Diagnostic analysis
â”‚   â”‚
â”‚   â”œâ”€â”€ template-system/               # Template & content management
â”‚   â”‚   â”œâ”€â”€ section-templates/         # Section templates
â”‚   â”‚   â”‚   â”œâ”€â”€ standardSectionTemplates.ts # Standard sections
â”‚   â”‚   â”‚   â””â”€â”€ productSectionTemplates.ts # Product-specific sections
â”‚   â”‚   â”œâ”€â”€ document-templates/        # Document templates
â”‚   â”‚   â”‚   â”œâ”€â”€ additionalDocuments.ts # Additional documents
â”‚   â”‚   â”‚   â””â”€â”€ documentBundles.ts     # Document bundles
â”‚   â”‚   â”œâ”€â”€ industry-variations/       # Industry-specific variations
â”‚   â”‚   â”‚   â””â”€â”€ industryVariations.ts  # Industry variations
â”‚   â”‚   â”œâ”€â”€ program-templates/         # Program-specific templates
â”‚   â”‚   â”‚   â”œâ”€â”€ programTemplates.ts    # Program templates
â”‚   â”‚   â”‚   â””â”€â”€ chapters.ts            # Chapter templates
â”‚   â”‚   â””â”€â”€ template-management/       # Template management
â”‚   â”‚       â”œâ”€â”€ editorTemplates.ts     # Editor templates
â”‚   â”‚       â””â”€â”€ loader.ts              # Template loader
â”‚   â”‚
â”‚   â”œâ”€â”€ financial-calculations/        # Financial calculations & pricing
â”‚   â”‚   â”œâ”€â”€ financialCalculator.ts     # Financial calculator
â”‚   â”‚   â”œâ”€â”€ pricing.ts                 # Pricing logic
â”‚   â”‚   â””â”€â”€ payments.ts                # Payment processing
â”‚   â”‚
â”‚   â”œâ”€â”€ ai-services/                   # AI & machine learning services
â”‚   â”‚   â”œâ”€â”€ aiHelper.ts                # AI helper functions
â”‚   â”‚   â”œâ”€â”€ aiHelperGuardrails.ts      # AI guardrails
â”‚   â”‚   â””â”€â”€ aiChipParser.ts            # AI chip parser
â”‚   â”‚
â”‚   â””â”€â”€ business-utilities/            # Business utility functions
â”‚       â”œâ”€â”€ requirementsMapper.ts      # Requirements mapping
â”‚       â”œâ”€â”€ routeExtras.ts             # Route extras
â”‚       â”œâ”€â”€ submissionPack.ts          # Submission pack
â”‚       â”œâ”€â”€ targetGroupDetection.ts    # Target group detection
â”‚       â”œâ”€â”€ teamManagement.ts          # Team management
â”‚       â”œâ”€â”€ multiUserDataManager.ts    # Multi-user data management
â”‚       â”œâ”€â”€ prefill.ts                 # Prefill logic
â”‚       â”œâ”€â”€ sourceRegister.ts          # Source register
â”‚       â””â”€â”€ translationValidator.ts    # Translation validator
â”‚
â”œâ”€â”€ data-access-layer/                 # LAYER 3: Data management & storage
â”‚   â”œâ”€â”€ database/                      # Database management
â”‚   â”‚   â”œâ”€â”€ database.ts                # Database connection
â”‚   â”‚   â”œâ”€â”€ migrations/                # Database migrations
â”‚   â”‚   â”‚   â”œâ”€â”€ setup-database.sql     # Database setup
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate-database.sql   # Database migration
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate-enhanced-requirements.sql # Enhanced requirements migration
â”‚   â”‚   â”‚   â”œâ”€â”€ fix-json-data.sql      # JSON data fix
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate.js             # Migration script
â”‚   â”‚   â”‚   â””â”€â”€ add-categorized-requirements.js # Add categorized requirements
â”‚   â”‚   â””â”€â”€ schemas/                   # Database schemas
â”‚   â”‚       â”œâ”€â”€ index.ts               # Schema index
â”‚   â”‚       â”œâ”€â”€ fundingProfile.ts      # Funding profile schema
â”‚   â”‚       â””â”€â”€ userProfile.ts         # User profile schema
â”‚   â”œâ”€â”€ storage/                       # Data storage
â”‚   â”‚   â”œâ”€â”€ planStore.ts               # Plan storage
â”‚   â”‚   â””â”€â”€ multiUserDataManager.ts    # Multi-user data management
â”‚   â”œâ”€â”€ static-data/                   # Static data files
â”‚   â”‚   â”œâ”€â”€ data/fallback-programs.json # Fallback programs data
â”‚   â”‚   â”œâ”€â”€ data/migrated-programs.json # Migrated programs data
â”‚   â”‚   â”œâ”€â”€ pricingData.ts             # Pricing data
â”‚   â”‚   â”œâ”€â”€ questions.ts               # Questions data
â”‚   â”‚   â”œâ”€â”€ documentBundles.ts         # Document bundles data
â”‚   â”‚   â”œâ”€â”€ documentDescriptions.ts    # Document descriptions data
â”‚   â”‚   â””â”€â”€ officialTemplates.ts       # Official templates data
â”‚   â””â”€â”€ external-apis/                 # External API integrations
â”‚       â”œâ”€â”€ airtable.ts                # Airtable integration
â”‚       â””â”€â”€ export.ts                  # Export functionality
â”‚
â”œâ”€â”€ system-core/                       # LAYER 4: Core system functionality
â”‚   â”œâ”€â”€ state-management/              # State management
â”‚   â”‚   â”œâ”€â”€ contexts/                  # React contexts
â”‚   â”‚   â”‚   â”œâ”€â”€ I18nContext.tsx        # Internationalization context
â”‚   â”‚   â”‚   â”œâ”€â”€ RecommendationContext.tsx # Recommendation context
â”‚   â”‚   â”‚   â””â”€â”€ UserContext.tsx        # User context
â”‚   â”‚   â””â”€â”€ hooks/                     # Custom hooks
â”‚   â”‚       â”œâ”€â”€ useOptimizedEditorData.ts # Optimized editor data hook
â”‚   â”‚       â””â”€â”€ useRealTimeRecommendations.ts # Real-time recommendations hook
â”‚   â”œâ”€â”€ type-definitions/              # Type definitions
â”‚   â”‚   â”œâ”€â”€ types.ts                   # Main types
â”‚   â”‚   â”œâ”€â”€ plan.ts                    # Plan types
â”‚   â”‚   â”œâ”€â”€ editor.ts                  # Editor types
â”‚   â”‚   â”œâ”€â”€ reco.ts                    # Recommendation types
â”‚   â”‚   â”œâ”€â”€ readiness.ts               # Readiness types
â”‚   â”‚   â””â”€â”€ requirements.ts            # Requirements types
â”‚   â”œâ”€â”€ utilities/                     # Utility functions
â”‚   â”‚   â”œâ”€â”€ utils.ts                   # General utilities
â”‚   â”‚   â”œâ”€â”€ analytics.ts               # Analytics utilities
â”‚   â”‚   â”œâ”€â”€ email.ts                   # Email utilities
â”‚   â”‚   â”œâ”€â”€ seo.ts                     # SEO utilities
â”‚   â”‚   â”œâ”€â”€ theme.ts                   # Theme utilities
â”‚   â”‚   â”œâ”€â”€ motion.ts                  # Motion utilities
â”‚   â”‚   â”œâ”€â”€ featureFlags.ts            # Feature flags
â”‚   â”‚   â””â”€â”€ payload.ts                 # Payload utilities
â”‚   â”œâ”€â”€ integrations/                  # External integrations
â”‚   â”‚   â”œâ”€â”€ comprehensiveExport.ts     # Comprehensive export
â”‚   â”‚   â””â”€â”€ renderer.tsx               # Export renderer
â”‚   â””â”€â”€ i18n/                          # Internationalization
â”‚       â”œâ”€â”€ settings.ts                # i18n settings
â”‚       â”œâ”€â”€ de.json                    # German translations
â”‚       â””â”€â”€ en.json                    # English translations
â”‚
â”œâ”€â”€ infrastructure-layer/              # LAYER 5: Infrastructure & tooling
â”‚   â”œâ”€â”€ configuration/                 # Configuration files
â”‚   â”‚   â”œâ”€â”€ package.json               # Package configuration
â”‚   â”‚   â”œâ”€â”€ package-lock.json          # Package lock file
â”‚   â”‚   â”œâ”€â”€ tsconfig.json              # TypeScript configuration
â”‚   â”‚   â”œâ”€â”€ tsconfig.tsbuildinfo       # TypeScript build info
â”‚   â”‚   â”œâ”€â”€ next.config.js             # Next.js configuration
â”‚   â”‚   â”œâ”€â”€ next-env.d.ts              # Next.js environment types
â”‚   â”‚   â”œâ”€â”€ tailwind.config.js         # Tailwind CSS configuration
â”‚   â”‚   â”œâ”€â”€ postcss.config.js          # PostCSS configuration
â”‚   â”‚   â”œâ”€â”€ eslint.config.js           # ESLint configuration
â”‚   â”‚   â”œâ”€â”€ .eslintrc.json             # ESLint configuration (legacy)
â”‚   â”‚   â”œâ”€â”€ .env.example               # Environment variables example
â”‚   â”‚   â””â”€â”€ .env.local                 # Local environment variables
â”‚   â”œâ”€â”€ build-tools/                   # Build & development tools
â”‚   â”‚   â”œâ”€â”€ scripts/                   # Build scripts
â”‚   â”‚   â”‚   â”œâ”€â”€ ci-coverage.mjs        # CI coverage script
â”‚   â”‚   â”‚   â”œâ”€â”€ generate-source-register.mjs # Source register generation
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate-to-json.js     # Migration to JSON script
â”‚   â”‚   â”‚   â”œâ”€â”€ run-tests.mjs          # Test runner script
â”‚   â”‚   â”‚   â”œâ”€â”€ update-fallback-data.js # Update fallback data script
â”‚   â”‚   â”‚   â””â”€â”€ README.md              # Scripts README
â”‚   â”‚   â””â”€â”€ analysis-tools/            # Analysis tools
â”‚   â”‚       â”œâ”€â”€ import_analyzer.py     # Import analyzer
â”‚   â”‚       â”œâ”€â”€ improved_master_analyzer.py # Improved master analyzer
â”‚   â”‚       â”œâ”€â”€ master_analyzer.py     # Master analyzer
â”‚   â”‚       â”œâ”€â”€ system_flow_analyzer.py # System flow analyzer
â”‚   â”‚       â””â”€â”€ system_requirements_checker.py # System requirements checker
â”‚   â”œâ”€â”€ deployment/                    # Deployment configuration
â”‚   â”‚   â”œâ”€â”€ .vercel/project.json       # Vercel project configuration
â”‚   â”‚   â””â”€â”€ .vercel/README.txt         # Vercel README
â”‚   â””â”€â”€ documentation/                 # Documentation
â”‚       â”œâ”€â”€ docs/                      # Documentation files
â”‚       â”‚   â”œâ”€â”€ README.md              # Main README
â”‚       â”‚   â”œâ”€â”€ architecture/ARCHITECTURE.md # Architecture documentation
â”‚       â”‚   â””â”€â”€ implementation/        # Implementation documentation
â”‚       â”‚       â”œâ”€â”€ IMPLEMENTATION_PLAN.md # Implementation plan
â”‚       â”‚       â”œâ”€â”€ GPT_REQUIREMENTS_AGENT_PROMPT.md # GPT requirements prompt
â”‚       â”‚       â”œâ”€â”€ REPO_CLEANUP_PLAN.md # Repo cleanup plan
â”‚       â”‚       â”œâ”€â”€ COMPLETE_REPO_RESTRUCTURE_PLAN.md # Complete restructure plan
â”‚       â”‚       â””â”€â”€ COMPLETE_FILE_MAPPING_AND_RESTRUCTURE.md # File mapping
â”‚       â””â”€â”€ README.md                  # Root README
â”‚
â”œâ”€â”€ assets/                            # LAYER 6: Static assets
â”‚   â”œâ”€â”€ public/                        # Public assets
â”‚   â”‚   â”œâ”€â”€ og-image.jpg               # Open Graph image
â”‚   â”‚   â”œâ”€â”€ og-image.svg               # Open Graph SVG
â”‚   â”‚   â”œâ”€â”€ robots.txt                 # Robots.txt
â”‚   â”‚   â””â”€â”€ sitemap.xml                # Sitemap
â”‚   â”œâ”€â”€ styles/                        # Stylesheets
â”‚   â”‚   â””â”€â”€ globals.css                # Global CSS
â”‚   â””â”€â”€ temporary/                     # Temporary files
â”‚       â””â”€â”€ tatus                      # Temporary status file
â”‚
â””â”€â”€ legacy/                            # Files to be removed/consolidated
    â”œâ”€â”€ src/editor/ (7 files - to be merged into presentation-layer/ui-components/business-plan-editor/)
    â”œâ”€â”€ src/lib/editor/ (2 files - to be moved to business-logic-layer/)
    â”œâ”€â”€ src/lib/examples/ (1 file - to be moved to business-logic-layer/)
    â”œâ”€â”€ src/lib/templates/ (5 files - to be moved to business-logic-layer/template-system/)
    â”œâ”€â”€ src/lib/validation/ (2 files - to be moved to business-logic-layer/data-processing/validation/)
    â”œâ”€â”€ src/lib/types/ (empty - to be removed)
    â””â”€â”€ src/reco/ (1 file - to be moved to business-logic-layer/recommendation-engine/)
```

---

## ğŸ“Š LAYER BREAKDOWN & RESPONSIBILITIES

### **LAYER 1: PRESENTATION LAYER (168 files)**
**Purpose**: User-facing interfaces and interactions
- **Web Pages (25 files)**: Next.js pages organized by function
- **UI Components (123 files)**: React components organized by business function
- **API Endpoints (20 files)**: REST API endpoints for data access

### **LAYER 2: BUSINESS LOGIC LAYER (47 files)**
**Purpose**: Core business functions and processing
- **Data Collection (6 files)**: Web scraping, parsing, data sources
- **Data Processing (8 files)**: Categorization, recommendation engine, validation
- **Template System (8 files)**: Templates, documents, industry variations
- **Financial Calculations (3 files)**: Financial logic, pricing, payments
- **AI Services (3 files)**: AI helpers, guardrails, parsing
- **Business Utilities (19 files)**: Business-specific utility functions

### **LAYER 3: DATA ACCESS LAYER (15 files)**
**Purpose**: Data management and storage
- **Database (8 files)**: Database connection, migrations, schemas
- **Storage (2 files)**: Data storage and management
- **Static Data (7 files)**: Static data files and configurations
- **External APIs (2 files)**: External service integrations

### **LAYER 4: SYSTEM CORE (25 files)**
**Purpose**: Core system functionality
- **State Management (5 files)**: React contexts and custom hooks
- **Type Definitions (8 files)**: TypeScript type definitions
- **Utilities (7 files)**: General utility functions
- **Integrations (2 files)**: System integrations
- **i18n (3 files)**: Internationalization

### **LAYER 5: INFRASTRUCTURE LAYER (28 files)**
**Purpose**: Infrastructure, tooling, and configuration
- **Configuration (12 files)**: Build and runtime configuration
- **Build Tools (15 files)**: Build scripts and analysis tools
- **Deployment (2 files)**: Deployment configuration
- **Documentation (1 file)**: System documentation

### **LAYER 6: ASSETS (6 files)**
**Purpose**: Static assets and resources
- **Public Assets (4 files)**: Publicly accessible assets
- **Styles (1 file)**: Stylesheets
- **Temporary (1 file)**: Temporary files

---

## ğŸ¯ KEY IMPROVEMENTS

1. **CLEAR LAYER SEPARATION** - Each layer has a specific purpose and responsibility
2. **COMPREHENSIVE MAPPING** - Every single file (283) is mapped to its appropriate layer
3. **FUNCTION-BASED ORGANIZATION** - Components grouped by business function, not technical type
4. **SCALABLE ARCHITECTURE** - Easy to add new functionality within the appropriate layer
5. **NO DUPLICATES** - Eliminates the editor duplication issue
6. **MAINTAINABLE STRUCTURE** - Clear hierarchy makes maintenance easier

---

## ğŸš€ MIGRATION STRATEGY

### **PHASE 1: Create Layer Structure (30 min)**
- Create all layer directories
- Set up barrel exports for clean imports

### **PHASE 2: Move Business Logic (1.5 hours)**
- Move all lib files to appropriate business-logic-layer folders
- Update imports and references

### **PHASE 3: Move UI Components (2 hours)**
- Move all components to presentation-layer/ui-components
- Consolidate editor files
- Update imports

### **PHASE 4: Move Pages & APIs (1 hour)**
- Organize pages by function
- Move API routes to presentation-layer/api-endpoints
- Update imports

### **PHASE 5: Move Data & Core (1 hour)**
- Move data files to data-access-layer
- Move system core files to system-core
- Update imports

### **PHASE 6: Move Infrastructure (30 min)**
- Move configuration and build tools to infrastructure-layer
- Update imports

### **PHASE 7: Cleanup & Test (1 hour)**
- Remove legacy folders
- Test all functionality
- Fix any remaining imports

**TOTAL TIME: 7-8 hours**

---

## ğŸ“‹ SUCCESS CRITERIA

- [ ] All 283 files properly mapped to layers
- [ ] Clear separation of concerns
- [ ] No duplicate functionality
- [ ] All imports working correctly
- [ ] System builds without errors
- [ ] All functionality working
- [ ] Easy to navigate and maintain
