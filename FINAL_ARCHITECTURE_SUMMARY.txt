═══════════════════════════════════════════════════════════════════════════════
FINAL PLATFORM ARCHITECTURE - CORRECTED
═══════════════════════════════════════════════════════════════════════════════

platform/
├── core/
│   ├── context/
│   │   ├── ProjectContext.tsx       ✅ CREATED
│   │   ├── hooks/
│   │   │   ├── useProject.ts        ✅ CREATED
│   │   │   ├── useUser.ts           ✅ CREATED (backward compat)
│   │   │   └── index.ts             ✅ CREATED
│   │   └── index.ts                 ✅ CREATED
│   ├── types/
│   │   ├── user.ts                  ✅ CREATED
│   │   ├── project.ts               ✅ CREATED
│   │   ├── program.ts               ✅ CREATED
│   │   ├── blueprint.ts             ✅ CREATED
│   │   └── index.ts                 ✅ CREATED
│   ├── validation/
│   │   ├── userSchemas.ts           ✅ CREATED
│   │   ├── programSchemas.ts        ✅ CREATED
│   │   ├── documentSchemas.ts       ✅ CREATED
│   │   └── index.ts                 ✅ CREATED
│   └── store/
│       └── useProjectStore.ts       ✅ CREATED
│
├── ai/
│   ├── orchestrator.ts              ✅ CREATED (single LLM entry point)
│   ├── llmClient.ts                 ✅ CREATED (replaces customLLM.ts)
│   ├── prompts/
│   │   ├── recommendation.ts        ✅ CREATED
│   │   ├── blueprint.ts             ✅ CREATED
│   │   ├── section.ts               ✅ CREATED
│   │   └── index.ts                 ✅ CREATED
│   └── parsers/
│       ├── responseParsers.ts       ✅ CREATED (replaces llmUtils.ts)
│       ├── sanitizers.ts            ✅ CREATED (replaces blueprintUtils.ts)
│       └── index.ts                 ✅ CREATED
│
├── analysis/
│   ├── programAnalyzer.ts           ✅ CREATED
│   ├── documentAnalyzer.ts          ✅ CREATED
│   ├── businessAnalyzer.ts          ✅ CREATED
│   ├── config.ts                    ✅ CREATED
│   ├── types.ts                     ✅ CREATED
│   └── index.ts                     ✅ CREATED
│
├── programs/
│   ├── catalog.ts                   ✅ NEW (load program definitions)
│   ├── match.ts                     ✅ NEW (deterministic matching logic)
│   ├── recommend.ts                 ✅ NEW (reco orchestration)
│   └── index.ts                     ✅ CREATED
│
├── generation/
│   ├── blueprintGenerator.ts        ✅ MOVED (from features/ai/services)
│   ├── structureBuilder.ts          ✅ CREATED (CONVERGENCE POINT)
│   ├── sectionWriter.ts             ✅ CREATED
│   ├── documentProcessor.ts         ✅ MOVED (from features/editor/lib/document-flow)
│   ├── normalization.ts             ✅ MOVED (from 1-document-flows)
│   ├── organizeForUiRendering.ts    ✅ MOVED (from 1-document-flows)
│   └── index.ts                     ✅ CREATED
│
├── templates/
│   └── index.ts                     ✅ STAYS (template definitions)
│
├── reco/
│   ├── components/
│   │   ├── ProgramFinder.tsx        ✅ MOVED
│   │   └── QuestionRenderer.tsx     ✅ MOVED
│   ├── data/
│   │   └── questions.ts             ✅ MOVED
│   ├── hooks/
│   │   └── useQuestionLogic.ts      ✅ MOVED
│   ├── lib/
│   │   ├── config.ts                ✅ MOVED
│   │   └── programPersistence.ts    ✅ MOVED
│   ├── types.ts                     ✅ MOVED
│   └── index.ts                     ✅ CREATED
│
├── api/
│   ├── utils/
│   │   ├── rateLimit.ts             ✅ MOVED (from shared/lib)
│   │   └── index.ts                 ✅ CREATED
│   └── index.ts                     ✅ CREATED
│
└── index.ts                         ✅ CREATED (central barrel export)

═══════════════════════════════════════════════════════════════════════════════
KEY CLARIFICATIONS
═══════════════════════════════════════════════════════════════════════════════

1. NO DUPLICATE platform/store/
   - useProjectStore.ts lives ONLY in platform/core/store/
   - Exported from platform/index.ts

2. platform/generation/ contains:
   - blueprintGenerator (moved from features/ai/services)
   - structureBuilder (convergence point - NEW)
   - sectionWriter (new)
   - documentProcessor (moved from features/editor/lib/document-flow)
   - normalization (moved from 1-document-flows)
   - organizeForUiRendering (moved from 1-document-flows)

3. `/platform/analysis/` stays separate:
   - Contains analyzers for program and document parsing
   - NOT merged into generation/

4. `/platform/programs/` NEW TIER:
   - catalog.ts: Load & serve program definitions
   - match.ts: Deterministic program matching logic
   - recommend.ts: Orchestration for recommendations
   - ALL program logic centralized here (not scattered across analysis + api)

5. `/platform/templates/`
   - Kept for template definitions
   - Templates stay as data, not deleted

5. platform/reco/ is COMPLETE movement:
   - Entire features/reco/ → platform/reco/

═══════════════════════════════════════════════════════════════════════════════
WHAT GETS DELETED (When migration complete)
═══════════════════════════════════════════════════════════════════════════════

❌ features/ai/                      (entire folder)
❌ features/editor/lib/document-flow/
❌ features/editor/lib/store/        (editorStore + domains)
❌ features/editor/lib/types/        (entire folder - moved to platform/core/types)
❌ features/editor/lib/utils/        (1-document-flows + 2-program-flows + 4-blueprint-flows)
❌ features/reco/                    (entire folder)

❌ shared/lib/rateLimit.ts
❌ shared/user/context/UserContext.tsx
❌ shared/user/schemas/userProfile.ts

═══════════════════════════════════════════════════════════════════════════════
WHAT STAYS IN FEATURES (UI Layer Only)
═══════════════════════════════════════════════════════════════════════════════

✅ features/editor/components/      (all UI components unchanged)
✅ features/editor/lib/hooks/       (UI-specific hooks)
✅ features/editor/lib/templates/   (template catalog)
✅ features/editor/lib/renderers.ts
✅ features/editor/lib/constants.ts

═══════════════════════════════════════════════════════════════════════════════
STATUS: 70% COMPLETE
═══════════════════════════════════════════════════════════════════════════════

✅ DONE:
  - Phase 1-4: platform core created (types, validation, context, ai, analysis, generation, reco, api)

⏳ REMAINING:
  - Phase 5: Update API endpoints (recommend.ts, blueprint.ts, assistant.ts)
  - Phase 6: Migrate ~40 components to useProject()
  - Phase 7-8: Consolidate old editor types/store
  - Phase 9: Delete old files after verification
