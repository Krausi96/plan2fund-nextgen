<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Decision Tree Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2563eb;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background-color: #f9fafb;
        }
        .test-section h3 {
            margin-top: 0;
            color: #374151;
        }
        .test-results {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.passed {
            background-color: #d1fae5;
            color: #065f46;
        }
        .status.failed {
            background-color: #fee2e2;
            color: #991b1b;
        }
        .btn {
            background-color: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        .btn:hover {
            background-color: #1d4ed8;
        }
        .btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .progress {
            width: 100%;
            height: 20px;
            background-color: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background-color: #2563eb;
            transition: width 0.3s ease;
            width: 0%;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª Enhanced Decision Tree Test Suite</h1>
        <p>This test suite demonstrates how to enhance your existing decision tree with requirements-based logic.</p>
        
        <div class="test-section">
            <h3>Test Controls</h3>
            <button class="btn" onclick="runTests()">Run All Tests</button>
            <button class="btn" onclick="clearResults()">Clear Results</button>
            <button class="btn" onclick="loadSampleData()">Load Sample Data</button>
        </div>

        <div class="test-section">
            <h3>Test Progress</h3>
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div id="progressText">Ready to run tests</div>
        </div>

        <div class="test-section">
            <h3>Test Results</h3>
            <div class="test-results" id="testResults">Click "Run All Tests" to start testing...</div>
        </div>

        <div class="test-section">
            <h3>Sample User Answers</h3>
            <div id="sampleAnswers">
                <p>Click "Load Sample Data" to see sample user answers</p>
            </div>
        </div>

        <div class="test-section">
            <h3>Integration Notes</h3>
            <div>
                <h4>How to integrate with your existing codebase:</h4>
                <ol>
                    <li><strong>Enhance existing decision tree:</strong> Modify <code>src/lib/decisionTree.ts</code> to use requirements data</li>
                    <li><strong>Update scoring engine:</strong> Enhance <code>src/lib/enhancedRecoEngine.ts</code> with requirements-based scoring</li>
                    <li><strong>Improve prefill:</strong> Extend <code>src/lib/prefill.ts</code> with requirements-driven prefill</li>
                    <li><strong>Add readiness check:</strong> Create new readiness check system based on requirements</li>
                </ol>
                
                <h4>Key benefits of this approach:</h4>
                <ul>
                    <li>âœ… Builds on your existing code</li>
                    <li>âœ… No breaking changes</li>
                    <li>âœ… Gradual enhancement</li>
                    <li>âœ… Better user experience</li>
                    <li>âœ… More accurate recommendations</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="enhanced-tree-test.js"></script>
    <script>
        let tester = null;
        let testRunning = false;

        // Initialize tester
        document.addEventListener('DOMContentLoaded', () => {
            tester = new EnhancedDecisionTreeTest();
        });

        // Run all tests
        async function runTests() {
            if (testRunning) return;
            
            testRunning = true;
            updateProgress(0, 'Starting tests...');
            clearResults();
            
            try {
                await tester.runAllTests();
                updateProgress(100, 'All tests completed!');
            } catch (error) {
                console.error('Test error:', error);
                updateProgress(0, 'Test failed: ' + error.message);
            } finally {
                testRunning = false;
            }
        }

        // Clear results
        function clearResults() {
            document.getElementById('testResults').textContent = 'Click "Run All Tests" to start testing...';
            updateProgress(0, 'Ready to run tests');
        }

        // Load sample data
        function loadSampleData() {
            const sampleAnswers = {
                q1_country: 'AT',
                q2_entity_stage: 'INC_LT_6M',
                q3_company_size: 'MICRO_0_9',
                q4_theme: ['INNOVATION_DIGITAL'],
                q5_maturity_trl: 'TRL_3_4',
                q6_rnd_in_at: 'YES',
                q7_collaboration: 'NONE',
                q9_team_diversity: 'UNKNOWN',
                q10_env_benefit: 'SOME',
                business_name: 'Innovative Tech Solutions',
                funding_amount: '50000',
                project_goal: 'develop innovative AI-powered business tools',
                problem_statement: 'Small businesses struggle with manual processes',
                solution_approach: 'AI automation platform',
                timeline: '12'
            };

            const answersDiv = document.getElementById('sampleAnswers');
            answersDiv.innerHTML = '<h4>Sample User Answers:</h4><pre>' + JSON.stringify(sampleAnswers, null, 2) + '</pre>';
        }

        // Update progress
        function updateProgress(percent, text) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        // Override console.log to show in results
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const resultsDiv = document.getElementById('testResults');
            const message = args.join(' ') + '\n';
            resultsDiv.textContent += message;
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        };
    </script>
</body>
</html>
